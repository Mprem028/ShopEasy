{% extends 'base.html' %}
{% load static %}
{% block content %}

<h1 class="text-3xl font-bold mb-6 text-indigo-700">Admin Dashboard</h1>

<!-- Stat Cards -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
  <div class="bg-indigo-100 p-6 rounded-lg shadow-sm text-center">
    <div class="text-sm font-medium text-gray-600">Total Orders</div>
    <div class="text-3xl font-bold text-indigo-700">{{ total_orders }}</div>
  </div>
  <div class="bg-yellow-100 p-6 rounded-lg shadow-sm text-center">
    <div class="text-sm font-medium text-gray-600">Pending Orders</div>
    <div class="text-3xl font-bold text-yellow-600">{{ pending_orders }}</div>
  </div>
  <div class="bg-green-100 p-6 rounded-lg shadow-sm text-center">
    <div class="text-sm font-medium text-gray-600">Active Products</div>
    <div class="text-3xl font-bold text-green-600">{{ total_products }}</div>
  </div>
  <div class="bg-pink-100 p-6 rounded-lg shadow-sm text-center">
    <div class="text-sm font-medium text-gray-600">Total Revenue</div>
    <div class="text-3xl font-bold text-pink-600">₹{{ revenue }}</div>
  </div>
</div>

<!-- Chart Section -->
<div class="bg-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center">
  <h2 class="text-xl font-semibold text-gray-800 mb-4">Business Overview</h2>
  
  <!-- Fixed Chart Container -->
  <div class="w-full max-w-3xl h-64"> <!-- ~600px width, 250px height -->
    <canvas id="dashboardChart"></canvas>
  </div>
</div>

<!-- Chart.js Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const totalOrders   = {{ total_orders|default:0 }};
  const pendingOrders = {{ pending_orders|default:0 }};
  const totalProducts = {{ total_products|default:0 }};
  const revenue       = {{ revenue|default:0 }}; // in ₹

  // Show revenue in thousands so scale is similar to counts
  const revenueInK = Math.round(revenue / 1000);

  const ctx = document.getElementById('dashboardChart').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Total Orders', 'Pending Orders', 'Products', 'Revenue (₹ in K)'],
      datasets: [{
        label: 'E-commerce Overview',
        data: [totalOrders, pendingOrders, totalProducts, revenueInK],
        backgroundColor: [
          'rgba(99, 102, 241, 0.7)',
          'rgba(250, 204, 21, 0.7)',
          'rgba(34, 197, 94, 0.7)',
          'rgba(244, 114, 182, 0.7)'
        ],
        borderColor: [
          'rgba(99, 102, 241, 1)',
          'rgba(250, 204, 21, 1)',
          'rgba(34, 197, 94, 1)',
          'rgba(244, 114, 182, 1)'
        ],
        borderWidth: 2,
        borderRadius: 6
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      animation: {
        duration: 1500,
        easing: 'easeOutBounce'
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: { color: '#4B5563' }   // let Chart.js choose step size
        },
        x: {
          ticks: { color: '#4B5563' }
        }
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: '#1F2937',
          titleColor: '#F9FAFB',
          bodyColor: '#F9FAFB'
        }
      }
    }
  });
});
</script>


{% endblock %}
