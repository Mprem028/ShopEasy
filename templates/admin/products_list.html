{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="bg-white p-6 rounded-lg shadow-md">
  <div class="flex flex-col md:flex-row justify-between items-center mb-6">
    <h1 class="text-2xl font-bold text-indigo-600 mb-4 md:mb-0">Manage Products</h1>
    <a href="{% url 'admin_product_add' %}" 
       class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
       + Add Product
    </a>
  </div>

  <!-- Search Bar -->
  <form method="GET" class="mb-6 flex justify-end">
    <input 
      type="text" 
      name="q" 
      value="{{ request.GET.q }}"
      placeholder="Search products..." 
      class="w-full md:w-1/3 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400"
    />
    <button 
      type="submit"
      class="ml-2 bg-indigo-500 text-white px-4 py-2 rounded-lg hover:bg-indigo-600 transition">
      Search
    </button>
  </form>

  <!-- Products Table -->
  <div class="overflow-x-auto">
    <table class="min-w-full bg-white border border-gray-200 rounded-lg">
      <thead class="bg-gray-100">
        <tr class="text-gray-700 uppercase text-sm">
          <th class="py-3 px-4 text-left">#</th>
          <th class="py-3 px-4 text-left">Image</th>
          <th class="py-3 px-4 text-left">Name</th>
          <th class="py-3 px-4 text-left">Category</th>
          <th class="py-3 px-4 text-left">Price</th>
          <th class="py-3 px-4 text-left">Stock</th>
          <th class="py-3 px-4 text-left">Status</th>
          <th class="py-3 px-4 text-center">Actions</th>
        </tr>
      </thead>

      <tbody>
        {% for product in products %}
        <tr class="border-t hover:bg-gray-50">
          <td class="py-3 px-4">{{ forloop.counter }}</td>
          <td class="py-3 px-4">
            {% if product.image %}
              <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-10 h-10 rounded object-cover">
            {% else %}
              <span class="text-gray-400 italic">No image</span>
            {% endif %}
          </td>
          <td class="py-3 px-4 font-medium text-gray-800">{{ product.name }}</td>
          <td class="py-3 px-4 text-gray-600">{{ product.category|default:"—" }}</td>
          <td class="py-3 px-4 font-semibold text-gray-900">₹{{ product.price }}</td>
          <td class="py-3 px-4">{{ product.stock }}</td>
          <td class="py-3 px-4">
            {% if product.is_deleted %}
              <span class="text-red-500 font-medium">Inactive</span>
            {% else %}
              <span class="text-green-600 font-medium">Active</span>
            {% endif %}
          </td>
          <td class="py-3 px-4 text-center">
            <a href="{% url 'admin_product_edit' product.pk %}" 
               class="text-indigo-600 hover:text-indigo-800 font-medium transition">Edit</a>
            <span class="mx-1 text-gray-400">|</span>
            <a href="{% url 'admin_product_delete' product.pk %}" 
               class="text-red-500 hover:text-red-700 font-medium transition">Delete</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="py-6 text-center text-gray-500 italic">
            No products found.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="mt-6 flex justify-center">
    <div class="flex space-x-2">
      {% if products.has_previous %}
        <a href="?page={{ products.previous_page_number }}" 
           class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300">&laquo; Prev</a>
      {% endif %}

      <span class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded">
        Page {{ products.number }} of {{ products.paginator.num_pages }}
      </span>

      {% if products.has_next %}
        <a href="?page={{ products.next_page_number }}" 
           class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300">Next &raquo;</a>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

